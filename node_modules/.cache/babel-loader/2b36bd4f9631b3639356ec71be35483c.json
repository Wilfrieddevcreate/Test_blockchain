{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\wilfr\\\\OneDrive\\\\Documents\\\\maxitapbotlatestversionv2\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import signIn from\"../firebase/auth/signin\";import FormControls from\"./FormControl\";import{AiOutlineLoading3Quarters}from\"react-icons/ai\";import{IoCheckmarkCircle,IoWarningOutline}from\"react-icons/io5\";import Spinner from\"./Spinner\";import{getFirestore,doc,getDoc}from\"firebase/firestore\";import{images}from\"../constants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var LoginComp=function LoginComp(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),successMessage=_useState8[0],setSuccessMessage=_useState8[1];// Success message state\nvar navigate=useNavigate();var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),errorCode=_useState10[0],setErrorCode=_useState10[1];var handleForm=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var _yield$signIn,result,error,db,userRef,userDoc,userData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();if(!(!email||!password)){_context.next=4;break;}setErrorCode(\"Please enter both email and password.\");return _context.abrupt(\"return\");case 4:setLoading(true);_context.next=7;return signIn(email,password);case 7:_yield$signIn=_context.sent;result=_yield$signIn.result;error=_yield$signIn.error;if(!error){_context.next=14;break;}setLoading(false);setErrorCode(\"Incorrect login details!\");return _context.abrupt(\"return\",console.log(error));case 14:// Check user role immediately after successful sign-in\ndb=getFirestore();userRef=doc(db,\"users\",result.user.uid);_context.next=18;return getDoc(userRef);case 18:userDoc=_context.sent;if(userDoc.exists()){userData=userDoc.data();if(userData.role===\"admin\"){setErrorCode(\"\");setSuccessMessage(\"Login successful! Redirecting to dashboard...\");setTimeout(function(){navigate(\"/dashboardAdx/stats\");},2000);// Redirect after 2 seconds\n}else{setLoading(false);setErrorCode(\"Access denied: Admins only.\");}}else{setLoading(false);setErrorCode(\"User data not found.\");}case 20:case\"end\":return _context.stop();}}},_callee);}));return function handleForm(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[successMessage?/*#__PURE__*/_jsx(Spinner,{}):/*#__PURE__*/_jsxs(\"div\",{className:\"form-wrapper flex flex-col items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full text-center pb-4 flex flex-col items-center justify-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:images.tapImage,alt:\"ddfd\",className:\"w-[100px]\"}),/*#__PURE__*/_jsxs(\"h1\",{className:\"text-[24px] sm:text-[28px] font-medium pb-1\",children:[\"Maxitapbot \",/*#__PURE__*/_jsx(\"br\",{}),\"Admin Dashboard\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[#b0b0b0] text-[14px] sm:text-[13px] font-light\",children:\"Enter your email and password to login\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex flex-col items-center space-y-3 sm:space-y-4\",children:[/*#__PURE__*/_jsx(FormControls,{label:\"Email\",type:\"email\",id:\"email\",placeholder:\"Your email\",value:email,setValue:setEmail}),/*#__PURE__*/_jsx(FormControls,{label:\"Password\",type:\"password\",id:\"password\",placeholder:\"**********\",value:password,setValue:setPassword}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col items-center w-full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col items-center space-y-6 sm:space-y-4 w-full sm:w-[47%]\",children:/*#__PURE__*/_jsx(\"button\",{className:\"bg-[#ffffff] uppercase hover:bg-[#c2fa7c] w-full ease-in duration-300 text-[#000] text-[15px] justify-center text-center font-medium h-[50px] border-none outline-none rounded-[12px] flex items-center px-6\",onClick:handleForm,type:\"submit\",disabled:loading,children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[\"Logging in\",/*#__PURE__*/_jsx(AiOutlineLoading3Quarters,{size:18,className:\"animate-spin ml-[12px]\"})]}):\"Login\"})})})]})]}),errorCode&&/*#__PURE__*/_jsx(\"div\",{className:\"z-[60] ease-in duration-300 w-full fixed left-0 right-0 px-4 top-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full text-[#ff4d4d] flex items-center space-x-2 px-4 bg-[#121620ef] h-[50px] rounded-[8px]\",children:[/*#__PURE__*/_jsx(IoWarningOutline,{size:16}),/*#__PURE__*/_jsx(\"span\",{className:\"text-[15px]\",children:errorCode})]})}),successMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"z-[60] ease-in duration-300 w-full fixed left-0 right-0 px-4 top-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full text-[#4dff4d] flex items-center space-x-2 px-4 bg-[#121620ef] h-[50px] rounded-[8px]\",children:[/*#__PURE__*/_jsx(IoCheckmarkCircle,{size:16}),/*#__PURE__*/_jsx(\"span\",{className:\"text-[15px]\",children:successMessage})]})})]});};export default LoginComp;","map":null,"metadata":{},"sourceType":"module"}