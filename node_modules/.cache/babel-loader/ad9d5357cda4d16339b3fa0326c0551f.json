{"ast":null,"code":"import _defineProperty from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\wilfr\\\\OneDrive\\\\Documents\\\\maxitapbotlatestversionv2\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from'react';import{db}from'../firebase/firestore';// adjust the path as needed\nimport{collection,setDoc,updateDoc,deleteDoc,doc,getDocs,getDoc}from\"firebase/firestore\";import Spinner from'./Spinner';import{IoCloseCircleSharp}from'react-icons/io5';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AdminPanel=function AdminPanel(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tasks=_useState2[0],setTasks=_useState2[1];var _useState3=useState({title:'',bonus:0,id:'',link:'',icon:'',chatId:''}),_useState4=_slicedToArray(_useState3,2),taskData=_useState4[0],setTaskData=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showTaskInputs=_useState6[0],setShowTaskInputs=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),successMessage=_useState8[0],setSuccessMessage=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isEditing=_useState10[0],setIsEditing=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),currentTaskId=_useState12[0],setCurrentTaskId=_useState12[1];var _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),loading=_useState14[0],setLoading=_useState14[1];useEffect(function(){fetchTasks();},[]);var fetchTasks=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var querySnapshot,tasksList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getDocs(collection(db,\"tasks\"));case 2:querySnapshot=_context.sent;tasksList=querySnapshot.docs.map(function(doc){return _objectSpread({id:doc.id},doc.data());});setTasks(tasksList);setLoading(false);case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchTasks(){return _ref.apply(this,arguments);};}();var fetchCounter=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var counterDoc;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getDoc(doc(db,\"counters\",\"taskCounter\"));case 2:counterDoc=_context2.sent;if(!counterDoc.exists()){_context2.next=7;break;}return _context2.abrupt(\"return\",counterDoc.data().currentId);case 7:_context2.next=9;return setDoc(doc(db,\"counters\",\"taskCounter\"),{currentId:0});case 9:return _context2.abrupt(\"return\",0);case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchCounter(){return _ref2.apply(this,arguments);};}();var incrementCounter=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var currentId,newId;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetchCounter();case 2:currentId=_context3.sent;newId=currentId+1;_context3.next=6;return setDoc(doc(db,\"counters\",\"taskCounter\"),{currentId:newId});case 6:return _context3.abrupt(\"return\",newId);case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function incrementCounter(){return _ref3.apply(this,arguments);};}();var handleInputChange=function handleInputChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setTaskData(_objectSpread(_objectSpread({},taskData),{},_defineProperty({},name,name==='bonus'?value===''?'':Number(value):value)));};var handleAddTask=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var newId,taskDoc;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return incrementCounter();case 3:newId=_context4.sent;taskDoc=doc(db,\"tasks\",newId.toString());_context4.next=7;return setDoc(taskDoc,_objectSpread(_objectSpread({},taskData),{},{id:newId}));case 7:setSuccessMessage('Task successfully added!');setShowTaskInputs(false);setTaskData({title:'',bonus:0,id:'',link:'',icon:'',chatId:''});fetchTasks();_context4.next=16;break;case 13:_context4.prev=13;_context4.t0=_context4[\"catch\"](0);console.error(\"Error adding document: \",_context4.t0);case 16:case\"end\":return _context4.stop();}}},_callee4,null,[[0,13]]);}));return function handleAddTask(){return _ref4.apply(this,arguments);};}();var handleEditTask=function handleEditTask(task){setTaskData(task);setShowTaskInputs(true);setIsEditing(true);setCurrentTaskId(task.id);};var handleUpdateTask=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var taskDoc;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:taskDoc=doc(db,\"tasks\",currentTaskId.toString());_context5.prev=1;_context5.next=4;return updateDoc(taskDoc,{title:taskData.title,bonus:taskData.bonus,link:taskData.link,icon:taskData.icon,chatId:taskData.chatId});case 4:setSuccessMessage('Task successfully updated!');setShowTaskInputs(false);setTaskData({title:'',bonus:0,id:'',link:'',icon:'',chatId:''});setIsEditing(false);setCurrentTaskId('');fetchTasks();_context5.next=15;break;case 12:_context5.prev=12;_context5.t0=_context5[\"catch\"](1);console.error(\"Error updating document: \",_context5.t0);case 15:case\"end\":return _context5.stop();}}},_callee5,null,[[1,12]]);}));return function handleUpdateTask(){return _ref5.apply(this,arguments);};}();var handleDeleteTask=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(id){var taskDoc;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;taskDoc=doc(db,\"tasks\",id.toString());_context6.next=4;return deleteDoc(taskDoc);case 4:fetchTasks();_context6.next=10;break;case 7:_context6.prev=7;_context6.t0=_context6[\"catch\"](0);console.error(\"Error deleting document: \",_context6.t0);case 10:case\"end\":return _context6.stop();}}},_callee6,null,[[0,7]]);}));return function handleDeleteTask(_x){return _ref6.apply(this,arguments);};}();var cancelEdits=function cancelEdits(){setIsEditing(false);setShowTaskInputs(!showTaskInputs);setTaskData({title:'',bonus:0,id:'',link:'',icon:'',chatId:''});};return/*#__PURE__*/_jsx(_Fragment,{children:loading?/*#__PURE__*/_jsx(Spinner,{}):/*#__PURE__*/_jsxs(\"div\",{id:\"refer\",className:\"w-full flex flex-col space-y-4 h-[100vh] scroller pt-4 overflow-y-auto pb-[150px]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-fit\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setShowTaskInputs(!showTaskInputs);},className:\"\".concat(showTaskInputs?'hidden':'block',\" bg-[#f5bb5f] font-semibold text-[15px] rounded-[6px] w-fit px-4 py-3 text-[#000] mb-4\"),children:showTaskInputs?'Cancel':'Add new task'})}),showTaskInputs&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full flex-wrap gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-full sm:w-[49%] gap-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-[13px] pl-1 pb-[2px] font-medium\",children:\"Task title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"title\",value:taskData.title,onChange:handleInputChange,placeholder:\"Title\",className:\"bg-[#4b4b4b] w-full placeholder:text-[#b9b9b9] text-[#e0e0e0] placeholder:text-[12px] text-[13px] placeholder:font-light h-[55px] border-none outline-none rounded-[10px] flex items-center px-6\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-full sm:w-[49%] gap-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-[13px] pl-1 pb-[2px] font-medium\",children:\"Task bonus amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"bonus\",value:taskData.bonus,onChange:handleInputChange,placeholder:\"Bonus\",className:\"bg-[#4b4b4b] placeholder:text-[#b9b9b9] text-[#e0e0e0] placeholder:text-[12px] text-[13px] placeholder:font-light h-[55px] border-none outline-none rounded-[10px] flex items-center px-6\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-full sm:w-[49%] gap-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-[13px] pl-1 pb-[2px] font-medium\",children:\"Task link\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"link\",value:taskData.link,onChange:handleInputChange,placeholder:\"Link\",className:\"bg-[#4b4b4b] placeholder:text-[#b9b9b9] text-[#e0e0e0] placeholder:text-[12px] text-[13px] placeholder:font-light h-[55px] border-none outline-none rounded-[10px] flex items-center px-6\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-full sm:w-[49%] gap-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-[13px] pl-1 pb-[2px] font-medium\",children:\"Task icon url\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"icon\",value:taskData.icon,onChange:handleInputChange,placeholder:\"Icon\",className:\"bg-[#4b4b4b] placeholder:text-[#b9b9b9] text-[#e0e0e0] placeholder:text-[12px] text-[13px] placeholder:font-light h-[55px] border-none outline-none rounded-[10px] flex items-center px-6\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-full sm:w-[49%] gap-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-[13px] pl-1 pb-[2px] font-medium\",children:\"Telegram Channel/Group ID\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"chatId\",value:taskData.chatId,onChange:handleInputChange,placeholder:\"Chat ID\",className:\"bg-[#4b4b4b] placeholder:text-[#b9b9b9] text-[#e0e0e0] placeholder:text-[12px] text-[13px] placeholder:font-light h-[55px] border-none outline-none rounded-[10px] flex items-center px-6\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-4\",children:isEditing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleUpdateTask,className:\"bg-green-500 font-semibold text-[15px] rounded-[6px] w-full sm:w-[200px] h-fit px-4 py-3 text-[#fff]\",children:\"Update Task\"}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelEdits,className:\"bg-[#4a3a3a] font-semibold text-[15px] rounded-[6px] w-full sm:w-[200px] h-fit px-4 py-3 text-[#fff]\",children:\"Cancel\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleAddTask,className:\"bg-[#f5bb5f] font-semibold text-[15px] rounded-[6px] w-full sm:w-[200px] h-fit px-4 py-3 text-[#000]\",children:\"Add Task\"}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelEdits,className:\"bg-[#4a3a3a] font-semibold text-[15px] rounded-[6px] w-full sm:w-[200px] h-fit px-4 py-3 text-[#fff]\",children:\"Cancel\"})]})})]}),successMessage&&/*#__PURE__*/_jsxs(\"div\",{className:\"modal fixed w-full h-full top-0 left-0 flex items-center justify-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay absolute w-full h-full bg-gray-900 opacity-50\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-container bg-[#595D65] w-11/12 md:max-w-md mx-auto rounded-[10px] shadow-lg z-50 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content py-4 text-left px-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end items-center pb-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-close cursor-pointer z-50\",onClick:function onClick(){return setSuccessMessage('');},children:/*#__PURE__*/_jsx(IoCloseCircleSharp,{size:32,className:\"text-secondary\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center\",children:/*#__PURE__*/_jsx(\"p\",{children:successMessage})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center pt-2\",children:/*#__PURE__*/_jsx(\"button\",{className:\"modal-close bg-blue-500 text-white p-2 px-6 rounded\",onClick:function onClick(){return setSuccessMessage('');},children:\"Close\"})})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap justify-between gap-4 w-full\",children:tasks.map(function(task){return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-[10px] bg-cards w-full sm:w-[49%] flex flex-col space-y-4\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-start gap-2 font-medium\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"\",children:/*#__PURE__*/_jsx(\"img\",{src:task.icon||'/telegram.svg',alt:task.title,className:\"w-[25px]\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"flex flex-col\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Title: \",task.title]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Bonus: \",task.bonus]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-start text-[13px] gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleEditTask(task);},className:\"bg-green-500 rounded-[6px] text-white px-2 py-[6px]\",children:\"Edit\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return handleDeleteTask(task.id);},className:\"bg-red-500 rounded-[6px] text-white px-2 py-[6px]\",children:[\"Delete \",task.id]})]})]},task.id);})})]})});};export default AdminPanel;","map":null,"metadata":{},"sourceType":"module"}