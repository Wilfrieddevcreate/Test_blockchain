{"ast":null,"code":"import _toConsumableArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\wilfr\\\\OneDrive\\\\Documents\\\\maxitapbotlatestversionv2\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useRef,useState}from'react';import{doc,getDoc,updateDoc}from'firebase/firestore';import{db}from'../firebase/firestore';// Adjust the path as needed\nimport{AiOutlineLoading3Quarters}from\"react-icons/ai\";import{IoCheckmarkCircleSharp,IoClose}from\"react-icons/io5\";import{PiLockFill}from\"react-icons/pi\";import{useUser}from'../context/userContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Business=function Business(){var _useUser=useUser(),userLevelsMarket=_useUser.userLevelsMarket,marketTeam=_useUser.marketTeam,success=_useUser.success,totalMarketProfit=_useUser.totalMarketProfit,setTotalMarketProfit=_useUser.setTotalMarketProfit,setSuccess=_useUser.setSuccess,setUserLevelsMarket=_useUser.setUserLevelsMarket,balance=_useUser.balance,setBalance=_useUser.setBalance,refBonus=_useUser.refBonus,id=_useUser.id,profitHour=_useUser.profitHour,setProfitHour=_useUser.setProfitHour;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),upgrading=_useState2[0],setUpgrading=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),upgradeStatus=_useState4[0],setUpgradeStatus=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),openUpgrade=_useState6[0],setOpenUpgrade=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),selectedUpgrade=_useState8[0],setSelectedUpgrade=_useState8[1];var infoRefTwo=useRef(null);var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),openClaim=_useState10[0],setOpenClaim=_useState10[1];var handleClickOutside=function handleClickOutside(event){if(infoRefTwo.current&&!infoRefTwo.current.contains(event.target)){setOpenUpgrade(false);}};useEffect(function(){if(openUpgrade){document.addEventListener('mousedown',handleClickOutside);}else{document.removeEventListener('mousedown',handleClickOutside);}return function(){document.removeEventListener('mousedown',handleClickOutside);};},[openUpgrade]);var handleUpgrade=function handleUpgrade(index){var currentMarketLevel=userLevelsMarket[index];var nextMarketLevelData=marketTeam[index].level.find(function(l){return l.level===currentMarketLevel+1;});if(!nextMarketLevelData)return;setSelectedUpgrade({index:index,nextMarketLevelData:nextMarketLevelData,currentMarketLevel:currentMarketLevel});setOpenUpgrade(true);};var confirmUpgrade=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var index,nextMarketLevelData,currentMarketLevel,userRef,userDoc,userData,updatedmarketTeam,newMarketLevel,newMarketProfit,newTotalMarketProfit,updatedBalance,updatedProfitHour,updatedUserData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:index=selectedUpgrade.index,nextMarketLevelData=selectedUpgrade.nextMarketLevelData,currentMarketLevel=selectedUpgrade.currentMarketLevel;if(!(index===4&&userLevelsMarket[3]<3)){_context.next=5;break;}setUpgradeStatus(/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-modal rounded-[20px] py-[6px] flex items-center text-[#ffe253] px-4\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Upgrade to level 3 of finance management required\"})}));setTimeout(function(){setUpgrading(false);setUpgradeStatus('');},3000);return _context.abrupt(\"return\");case 5:if(!(index===5&&userLevelsMarket[4]<1)){_context.next=9;break;}setUpgradeStatus(/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-modal rounded-[20px] py-[6px] flex items-center text-[#ffe253] px-4\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Upgrade to level 1 of risk management required\"})}));setTimeout(function(){setUpgrading(false);setUpgradeStatus('');},3000);return _context.abrupt(\"return\");case 9:if(!(balance+refBonus<nextMarketLevelData.cost)){_context.next=14;break;}setUpgrading(true);setUpgradeStatus(/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-modal rounded-[20px] py-[6px] flex items-center text-[#ffe253] px-4\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Insufficient balance\"})}));setTimeout(function(){setUpgrading(false);setUpgradeStatus('');},3000);return _context.abrupt(\"return\");case 14:setUpgrading(true);setUpgradeStatus(/*#__PURE__*/_jsxs(\"div\",{className:\"w-full bg-modal rounded-[20px] py-[6px] flex items-center text-secondary px-6 space-x-2\",children:[/*#__PURE__*/_jsx(AiOutlineLoading3Quarters,{size:14,className:\"animate-spin\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Processing... please wait!\"})]}));userRef=doc(db,'telegramUsers',id.toString());_context.next=19;return getDoc(userRef);case 19:userDoc=_context.sent;if(userDoc.exists()){_context.next=23;break;}console.error('User document does not exist');return _context.abrupt(\"return\");case 23:userData=userDoc.data();updatedmarketTeam=userData.marketTeam?_toConsumableArray(userData.marketTeam):marketTeam.map(function(){return{title:'',level:0,profit:0,cost:0,totalMarketProfit:0// Initialize totalProfit if it doesn't exist\n};});newMarketLevel=currentMarketLevel+1;newMarketProfit=nextMarketLevelData.profit;newTotalMarketProfit=(updatedmarketTeam[index].totalMarketProfit||0)+newMarketProfit;updatedmarketTeam[index]={title:marketTeam[index].title,level:newMarketLevel,profit:newMarketProfit,cost:nextMarketLevelData.cost,totalMarketProfit:newTotalMarketProfit};updatedBalance=balance-nextMarketLevelData.cost;updatedProfitHour=profitHour+newMarketProfit;updatedUserData={balance:updatedBalance,profitHour:updatedProfitHour,marketTeam:updatedmarketTeam};_context.next=34;return updateDoc(userRef,updatedUserData);case 34:setTimeout(function(){setUserLevelsMarket(function(prevMarketLevels){return prevMarketLevels.map(function(level,i){return i===index?newMarketLevel:level;});});setTotalMarketProfit(function(prevTotalMarketProfits){return prevTotalMarketProfits.map(function(profit,i){return i===index?newTotalMarketProfit:profit;});});// Update total profits\nsetProfitHour(updatedProfitHour);setBalance(updatedBalance);setUpgradeStatus('');setSuccess(true);setOpenClaim(true);},1000);setTimeout(function(){setUpgrading(false);setUpgradeStatus('');setSuccess(false);},3000);setOpenUpgrade(false);case 37:case\"end\":return _context.stop();}}},_callee);}));return function confirmUpgrade(){return _ref.apply(this,arguments);};}();var formatNumber=function formatNumber(num){if(num<1000){return num;}else if(num<1000000){return(num/1000).toFixed(1).replace(/\\.0$/,'')+\"k\";}else{return(num/1000000).toFixed(1).replace(/\\.0$/,'')+\"M\";}};var formatNumberCi=function formatNumberCi(num){if(num<100000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else if(num<1000000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else{return(num/1000000).toFixed(3).replace(\".\",\".\")+\" M\";}};return/*#__PURE__*/_jsxs(_Fragment,{children:[marketTeam.map(function(market,index){var currentMarketLevel=userLevelsMarket[index];var marketProfitsTotal=totalMarketProfit[index];var nextMarketLevelData=market.level.find(function(l){return l.level===currentMarketLevel+1;});// eslint-disable-next-line\nvar currentMarketLevelData=market.level.find(function(l){return l.level===currentMarketLevel;});// eslint-disable-next-line\nvar maxMarketLevelReached=currentMarketLevel===market.level.length;var getLockMessage=function getLockMessage(){if(index===4&&userLevelsMarket[3]<3){return'finance mngmt lvl 3';}else if(index===5&&userLevelsMarket[4]<1){return'risk mngmt lvl 1';}return'Locked';};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-cards w-[48%] pt-4 pb-2 rounded-[15px] [&:nth-child(2)]:!mt-0 text-[13px] flex flex-col justify-between\",children:[/*#__PURE__*/_jsxs(\"button\",{disabled:upgrading===true,onClick:function onClick(){return handleUpgrade(index);},className:\"flex cursor-pointer w-full h-full items-center flex-col px-3 pb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-[60px] flex items-center pb-2 justify-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:market.icon,alt:market.title,className:\"w-[54px] h-[54px] rounded-full\"}),index===4&&userLevelsMarket[3]<3||index===5&&userLevelsMarket[4]<1?/*#__PURE__*/_jsx(\"div\",{className:\"flex h-[64px] w-[64px] absolute bg-[#52657dc1] rounded-full items-center justify-center\",children:/*#__PURE__*/_jsx(PiLockFill,{size:24,className:\"text-[#fff]\"})}):/*#__PURE__*/_jsx(_Fragment,{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium\",children:market.title}),/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-nowrap text-[10px]\",children:\"Profit per hour\"}),currentMarketLevel===0?/*#__PURE__*/_jsx(\"img\",{src:\"/coingrey.webp\",alt:\"coingray\",className:\"w-[10px]\"}):/*#__PURE__*/_jsx(\"img\",{src:\"/coin.webp\",alt:\"coingray\",className:\"w-[10px]\"}),/*#__PURE__*/_jsx(\"span\",{className:\"\".concat(currentMarketLevel===0?'text-secondary':'text-primary',\" font-semibold text-[12px]\"),children:currentMarketLevel===0?/*#__PURE__*/_jsxs(_Fragment,{children:[\"+\",nextMarketLevelData.profit]}):/*#__PURE__*/_jsx(_Fragment,{children:marketProfitsTotal})})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-[1px] bg-[#4141417b]\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center px-3 text-[14px] font-semibold py-[6px]\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-secondary text-nowrap\",children:[\"lvl \",currentMarketLevel]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-[1px] h-[14px] mx-[10px] bg-[#4141417b]\"}),nextMarketLevelData?/*#__PURE__*/_jsx(\"span\",{className:\"flex items-center space-x-2\",children:index===4&&userLevelsMarket[3]<3||index===5&&userLevelsMarket[4]<1?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{src:\"/coingrey.webp\",alt:\"coin\",className:\"w-[16px]\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-[10px]\",children:getLockMessage()})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{src:\"/coin.webp\",alt:\"coin\",className:\"w-[16px]\"}),/*#__PURE__*/_jsx(\"span\",{className:\"\",children:formatNumber(nextMarketLevelData.cost)})]})}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"span\",{className:\"text-secondary\",children:\"Max profit\"})})]})]},market.title);}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(upgrading?'visible top-1':'invisible top-[-12px] ease-out',\" ease-in transition-all duration-300 w-full flex absolute left-0 right-0 px-8\"),children:upgradeStatus}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(success?'visible top-[-6%] right-6':'invisible top-[-12px] ease-out',\" ease-in z-[60] transition-all duration-300 w-full flex justify-end absolute px-8\"),children:/*#__PURE__*/_jsx(\"img\",{src:\"/profithour.gif\",alt:\"fgdsfc\",className:\"w-[150px]\"})}),openUpgrade&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(openUpgrade?'flex':'hidden',\" fixed bottom-0 left-0 z-40 right-0 h-[100vh] bg-[#303030c4] flex-col justify-end items-center\"),children:/*#__PURE__*/_jsx(\"div\",{ref:infoRefTwo,className:\"w-full bg-divider shadowtop rounded-tl-[40px] rounded-tr-[40px] relative flex flex-col ease-in duration-300 transition-all justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex taskbg rounded-tl-[40px] rounded-tr-[40px] mt-[2px] justify-center relative flex-col items-center space-y-3 p-4 pt-20 pb-10\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setOpenUpgrade(false);},className:\"flex items-center justify-center h-[32px] w-[32px] rounded-full bg-[#383838] absolute right-6 top-4 text-center font-medium text-[16px]\",children:/*#__PURE__*/_jsx(IoClose,{size:20,className:\"text-[#9995a4]\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex justify-center flex-col items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-[80px] h-[80px] rounded-[25px] flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"claim\",src:marketTeam[selectedUpgrade.index].icon,className:\"w-[80px] rounded-full\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-[28px] text-center w-full\",children:marketTeam[selectedUpgrade.index].title}),/*#__PURE__*/_jsx(\"p\",{className:\"pb-6 text-primary text-[14px] px-4 text-center\",children:marketTeam[selectedUpgrade.index].description}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[13px]\",children:\"Profit per hour\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-1 items-center justify-center space-x-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/coin.webp\",className:\"w-[12px]\",alt:\"Coin Icon\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"font-bold text-[13px] flex items-center\",children:[\"+\",formatNumber(selectedUpgrade.nextMarketLevelData.profit)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-1 items-center space-x-2 pt-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/coin.webp\",className:\"w-[30px]\",alt:\"Coin Icon\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-[24px] flex items-center\",children:formatNumberCi(selectedUpgrade.nextMarketLevelData.cost)})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center pb-6 pt-4\",children:balance+refBonus>=selectedUpgrade.nextMarketLevelData.cost?/*#__PURE__*/_jsx(\"button\",{onClick:confirmUpgrade,disabled:upgrading===true,className:\"\".concat(selectedUpgrade.index===4&&userLevelsMarket[3]<3||selectedUpgrade.index===5&&userLevelsMarket[4]<1?'bg-[#42424264] text-[#979797]':'bg-btn4 text-[#000]',\" w-full py-5 px-3 flex items-center justify-center text-center rounded-[12px] font-semibold text-[18px]\"),children:selectedUpgrade.index===4&&userLevelsMarket[3]<3||selectedUpgrade.index===5&&userLevelsMarket[4]<1?/*#__PURE__*/_jsx(_Fragment,{children:\"Unlock required level first\"}):/*#__PURE__*/_jsx(_Fragment,{children:\"Go ahead\"})}):/*#__PURE__*/_jsx(\"button\",{disabled:upgrading===true,className:\"bg-[#42424264] text-[#979797] w-full py-5 px-3 flex items-center justify-center text-center rounded-[12px] font-semibold text-[18px]\",children:selectedUpgrade.index===4&&userLevelsMarket[3]<3||selectedUpgrade.index===5&&userLevelsMarket[4]<1?/*#__PURE__*/_jsx(_Fragment,{children:\"Unlock required level first\"}):/*#__PURE__*/_jsx(_Fragment,{children:\"Insufficient balance\"})})})]})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full absolute top-[50px] flex justify-center z-50 pointer-events-none select-none\",children:success?/*#__PURE__*/_jsx(\"img\",{src:\"/congrats.gif\",alt:\"congrats\",className:\"w-[80%]\"}):/*#__PURE__*/_jsx(_Fragment,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(openClaim===true?\"visible\":\"invisible\",\" fixed top-[-12px] claimdiv bottom-0 left-0 z-40 right-0 h-[100vh] bg-[#00000042] flex flex-col justify-center items-center px-4\"),children:/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(openClaim===true?\"opacity-100 mt-0 ease-in duration-300\":\"opacity-0 mt-[100px]\",\" w-full bg-modal rounded-[16px] relative flex flex-col justify-center p-8\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex justify-center flex-col items-center space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full items-center justify-center flex flex-col space-y-2\",children:[/*#__PURE__*/_jsx(IoCheckmarkCircleSharp,{size:32,className:\"text-accent\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:\"Let's go!!\"})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-center w-full text-[18px] text-[#ffffff] pt-2 pb-2\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-accent\",children:\"PPH UPGRADE SUCCESSFUL!\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"pb-6 text-[#bfbfbf] text-[15px] w-full text-center\",children:\"Keep grinding! something huge is coming! Get more PPH now!\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setOpenClaim(false);},className:\"bg-btn4 text-[#000] w-full py-[12px] px-6 flex items-center justify-center text-center rounded-[12px] font-medium text-[16px]\",children:\"Continue\"})})]})})})]});};export default Business;","map":null,"metadata":{},"sourceType":"module"}