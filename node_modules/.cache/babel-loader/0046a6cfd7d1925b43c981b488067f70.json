{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\wilfr\\\\OneDrive\\\\Documents\\\\maxitapbotlatestversionv2\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from'react';import{db}from'../firebase/firestore';// adjust the path as needed\nimport{collection,getDocs,query}from\"firebase/firestore\";import moment from'moment';import{NavLink}from'react-router-dom';import{PiArrowRight}from'react-icons/pi';import Spinner from'./Spinner';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var linksTo=[{link:'/dashboardAdx/managetasks',title:'Telegram Tasks'},{link:'/dashboardAdx/externaltasks',title:'Promo/External Tasks'},{link:'/dashboardAdx/youtube',title:'Youtube Tasks'},{link:'/dashboardAdx/wallets',title:'Airdrop list'},{link:'/dashboardAdx/search',title:'Search user'},{link:'/dashboardAdx/settings',title:'Settings'}];var StatisticsPanel=function StatisticsPanel(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),totalUsers=_useState2[0],setTotalUsers=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),totalBalance=_useState4[0],setTotalBalance=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),totalTapBalance=_useState6[0],setTotalTapBalance=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),activeUsersLast24Hours=_useState8[0],setActiveUsersLast24Hours=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),activeUsersLast1Hour=_useState10[0],setActiveUsersLast1Hour=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),activeUsersLast1Minute=_useState12[0],setActiveUsersLast1Minute=_useState12[1];// New state for last 1 minute\nvar _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),loading=_useState14[0],setLoading=_useState14[1];useEffect(function(){fetchStatistics();},[]);var fetchStatistics=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var last24Hours,last1Hour,last1Minute,usersQuery,querySnapshot,usersData,totalUsersCount,totalBalanceSum,totalTapBalanceSum,activeUsers24Hours,activeUsers1Hour,activeUsers1Minute;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// const now = moment();\nlast24Hours=moment().subtract(24,'hours').toDate();last1Hour=moment().subtract(1,'hour').toDate();last1Minute=moment().subtract(1,'minute').toDate();// New time range for last 1 minute\nconsole.log('Last 24 Hours:',last24Hours);console.log('Last 1 Hour:',last1Hour);usersQuery=query(collection(db,\"telegramUsers\"));_context.next=8;return getDocs(usersQuery);case 8:querySnapshot=_context.sent;usersData=querySnapshot.docs.map(function(doc){return doc.data();});// Total number of users\ntotalUsersCount=usersData.length;setTotalUsers(totalUsersCount);setLoading(false);// Total balance and total tap balance\ntotalBalanceSum=usersData.reduce(function(acc,user){return acc+(user.balance||0);},0);totalTapBalanceSum=usersData.reduce(function(acc,user){return acc+(user.tapBalance||0);},0);setTotalBalance(totalBalanceSum);setTotalTapBalance(totalTapBalanceSum);// Active users in the last 24 hours and last 1 hour\nactiveUsers24Hours=usersData.filter(function(user){return user.lastActive&&user.lastActive.toDate()>last24Hours;}).length;activeUsers1Hour=usersData.filter(function(user){return user.lastActive&&user.lastActive.toDate()>last1Hour;}).length;activeUsers1Minute=usersData.filter(function(user){return user.lastActive&&user.lastActive.toDate()>last1Minute;}).length;// New filter for last 1 minute\nsetActiveUsersLast24Hours(activeUsers24Hours);setActiveUsersLast1Hour(activeUsers1Hour);setActiveUsersLast1Minute(activeUsers1Minute);// Set state for last 1 minute\ncase 23:case\"end\":return _context.stop();}}},_callee);}));return function fetchStatistics(){return _ref.apply(this,arguments);};}();var formatNumber=function formatNumber(num){var _num$toString$split$;if(typeof num!==\"number\"){return\"Invalid number\";}// If the number is less than 1 and has more than 3 decimal places\nif(num<1&&((_num$toString$split$=num.toString().split('.')[1])===null||_num$toString$split$===void 0?void 0:_num$toString$split$.length)>3){return num.toFixed(6).replace(/0+$/,'');// Trims trailing zeroes\n}return num.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2});};var statista=[{title:'Total Users',count:totalUsers},{title:'Total Balance',count:formatNumber(totalBalance)},{title:'Total Taps',count:formatNumber(totalTapBalance)},{title:'Last 24hours',count:activeUsersLast24Hours},{title:'Last 1hour',count:activeUsersLast1Hour},{title:'Online Users',count:activeUsersLast1Minute// New entry for last 1 minute\n}];return/*#__PURE__*/_jsx(_Fragment,{children:loading?/*#__PURE__*/_jsx(Spinner,{}):/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex flex-col space-y-4 h-[100vh] scroller pt-4 overflow-y-auto pb-[150px]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-start items-start flex-wrap gap-4\",children:statista.map(function(stats,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-cards p-4 rounded-[10px] w-[47%] sm:w-[32%] h-[120px] flex flex-col justify-center space-y-3 \".concat(statista.length===5?'last:w-full sm:last:w-[64%]':''),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-[16px] sm:text-[18px] font-semibold text-[#bdbdbd]\",children:stats.title}),/*#__PURE__*/_jsx(\"span\",{className:\"text-[20px] sm:text-[24px] text-[#fff] font-bold\",children:stats.count})]},index);})}),/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-[17px] pt-3\",children:\"Admin Control Items\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col space-y-4 w-full\",children:linksTo.map(function(menu,index){return/*#__PURE__*/_jsxs(NavLink,{to:menu.link,className:\"bg-cards px-4 py-4 flex rounded-[6px] justify-between items-center space-x-1 font-medium\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"\",children:menu.title}),/*#__PURE__*/_jsx(\"span\",{className:\"\",children:/*#__PURE__*/_jsx(PiArrowRight,{size:16,className:\"\"})})]},index);})})]})});};export default StatisticsPanel;","map":null,"metadata":{},"sourceType":"module"}