{"ast":null,"code":"import _toConsumableArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\wilfr\\\\OneDrive\\\\Documents\\\\maxitapbotlatestversionv2\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState}from'react';import{updateDoc,doc}from'firebase/firestore';import{db}from'../firebase/firestore';import{useUser}from'../context/userContext';import{IoCheckmarkCircleSharp}from'react-icons/io5';import{texts}from'../constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var milestones=[{name:'Bronze',icon:'/bronze.webp',tapBalanceRequired:1000,reward:50000},{name:'Silver',icon:'/silver.webp',tapBalanceRequired:50000,reward:100000},{name:'Gold',icon:'/gold.webp',tapBalanceRequired:500000,reward:250000},{name:'Platinum',icon:'/platinum.webp',tapBalanceRequired:1000000,reward:500000},{name:'Diamond',icon:'/diamond.webp',tapBalanceRequired:2500000,reward:1000000},{name:'Master',icon:'/master.webp',tapBalanceRequired:5000000,reward:2500000}];var MilestoneRewards=function MilestoneRewards(){var _useUser=useUser(),tapBalance=_useUser.tapBalance,balance=_useUser.balance,setBalance=_useUser.setBalance,id=_useUser.id,claimedMilestones=_useUser.claimedMilestones,setClaimedMilestones=_useUser.setClaimedMilestones;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalOpen=_useState2[0],setModalOpen=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),modalMessage=_useState4[0],setModalMessage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),congrats=_useState6[0],setCongrats=_useState6[1];var handleClaim=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(milestone){var newBalance,userRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(tapBalance>=milestone.tapBalanceRequired&&!claimedMilestones.includes(milestone.name))){_context.next=19;break;}newBalance=balance+milestone.reward;_context.prev=2;userRef=doc(db,'telegramUsers',id);_context.next=6;return updateDoc(userRef,{balance:newBalance,claimedMilestones:[].concat(_toConsumableArray(claimedMilestones),[milestone.name])});case 6:setBalance(newBalance);setClaimedMilestones([].concat(_toConsumableArray(claimedMilestones),[milestone.name]));setModalMessage(/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex justify-center flex-col items-center space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full items-center justify-center flex flex-col space-y-2\",children:[/*#__PURE__*/_jsx(IoCheckmarkCircleSharp,{size:32,className:\"text-accent\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-center\",children:\"Let's go!!\"})]}),/*#__PURE__*/_jsxs(\"h3\",{className:\"font-medium text-[20px] text-[#ffffff] pt-2 pb-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-accent\",children:[\"+\",formatNumberCliam(milestone.reward)]}),\" \",texts.projectSymbol,\" CLAIMED\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"pb-6 text-[#bfbfbf] text-[15px] w-full text-center\",children:\"Keep tapping and performing tasks to unlock new milestones! something huge is coming!\"})]}));setModalOpen(true);setCongrats(true);setTimeout(function(){setCongrats(false);},4000);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](2);console.error('Error claiming milestone reward:',_context.t0);case 17:_context.next=21;break;case 19:setModalMessage('You have already claimed this milestone reward or do not meet the requirements.');setModalOpen(true);case 21:case\"end\":return _context.stop();}}},_callee,null,[[2,14]]);}));return function handleClaim(_x){return _ref.apply(this,arguments);};}();var formatNumberCliam=function formatNumberCliam(num){if(num<100000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else if(num<1000000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else if(num<10000000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else{return(num/10000000).toFixed(3).replace(\".\",\".\")+\" T\";}};var closeModal=function closeModal(){setModalOpen(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex flex-col space-y-4\",children:[milestones.filter(function(milestone){return!claimedMilestones.includes(milestone.name);}).map(function(milestone){var progress=tapBalance/milestone.tapBalanceRequired*100;var isClaimable=tapBalance>=milestone.tapBalanceRequired&&!claimedMilestones.includes(milestone.name);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-cards rounded-[15px] p-[14px] flex flex-wrap justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-1 items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsx(\"img\",{src:milestone.icon,alt:\"bronze\",className:\"w-[48px]\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-[15px]\",children:milestone.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"\",children:/*#__PURE__*/_jsx(\"span\",{className:\"w-[10px] h-[10px] bg-[#be8130] rounded-full flex items-center\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-[14px]\",children:formatNumberCliam(milestone.reward)})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsx(\"button\",{className:\"w-fit relative rounded-[8px] font-semibold py-2 px-3 \".concat(isClaimable?'bg-btn4  text-[#000] hover:bg-[#b4b4b4] ease-in duration-200':'bg-[#0000004a] text-[#888] cursor-not-allowed'),disabled:!isClaimable,onClick:function onClick(){return handleClaim(milestone);},children:isClaimable?'Claim':'Claim'})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex w-full mt-2 p-[4px] items-center bg-energybar rounded-[10px] border-[1px] border-borders2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-[8px] rounded-[8px] \".concat(progress>=100?'bg-[#be8130]':'bg-[#be8130]'),style:{width:\"\".concat(progress>100?100:progress,\"%\")}})})]},milestone.name);}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full absolute top-[50px] left-0 right-0 flex justify-center z-50 pointer-events-none select-none\",children:congrats?/*#__PURE__*/_jsx(\"img\",{src:\"/congrats.gif\",alt:\"congrats\",className:\"w-[80%]\"}):/*#__PURE__*/_jsx(_Fragment,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(modalOpen===true?\"visible\":\"invisible\",\" fixed top-[-12px] bottom-0 left-0 z-40 right-0 h-[100vh] bg-[#00000042] flex justify-center items-center backdrop-blur-[6px] px-4\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(modalOpen===true?\"opacity-100 mt-0\":\"opacity-0 mt-[100px]\",\" w-full bg-modal relative rounded-[16px] flex flex-col justify-center p-8 ease-in duration-300 transition-all\"),children:[modalMessage,/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:closeModal,className:\"bg-btn4 w-fit py-[10px] px-6 flex items-center justify-center text-center rounded-[12px] font-medium text-[16px]\",children:\"Continue to next\"})})]})})]});};export default MilestoneRewards;","map":null,"metadata":{},"sourceType":"module"}