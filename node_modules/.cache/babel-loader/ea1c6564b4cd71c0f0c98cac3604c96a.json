{"ast":null,"code":"import _toConsumableArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\wilfr\\\\OneDrive\\\\Documents\\\\maxitapbotlatestversionv2\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState}from'react';import{updateDoc,doc,arrayUnion,increment}from'firebase/firestore';import{db}from'../firebase/firestore';// Import Firestore configuration\nimport axios from'axios';import Animate from'../Components/Animate';import{NavLink,Outlet}from'react-router-dom';import{useUser}from\"../context/userContext\";import ManualTasks from'../Components/ManualTasks';import{PiNotebook,PiUsersThree,PiYoutubeLogo}from'react-icons/pi';import{IoCheckmarkCircleSharp}from'react-icons/io5';import{RiArrowRightSLine}from\"react-icons/ri\";import Levels from'../Components/Levels';import Referrals from'../Components/Referrals';import YouTubeTasks from'../Components/YoutubeTasks';import{images,texts}from\"../constants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var TasksList=function TasksList(){var _useUser=useUser(),id=_useUser.id,balance=_useUser.balance,refBonus=_useUser.refBonus,setBalance=_useUser.setBalance,completedTasks=_useUser.completedTasks,setCompletedTasks=_useUser.setCompletedTasks,tasks=_useUser.tasks,setTasks=_useUser.setTasks;// Assuming 'id' is the user's document ID in Firestore\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalOpen=_useState2[0],setModalOpen=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),countdowns=_useState4[0],setCountdowns=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),currentError=_useState6[0],setCurrentError=_useState6[1];// Task-specific error messages\nvar _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),showVerifyButtons=_useState8[0],setShowVerifyButtons=_useState8[1];// State to manage the display of Verify buttons\nvar _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),countdownFinished=_useState10[0],setCountdownFinished=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),claiming=_useState12[0],setClaiming=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),claimError=_useState14[0],setClaimError=_useState14[1];var _useState15=useState(1),_useState16=_slicedToArray(_useState15,2),activeIndex=_useState16[0],setActiveIndex=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),claimedBonus=_useState18[0],setClaimedBonus=_useState18[1];// New state to store the claimed bonus amount\nvar _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),congrats=_useState20[0],setCongrats=_useState20[1];var _useState21=useState(),_useState22=_slicedToArray(_useState21,2),showLevel=_useState22[0],setShowLevel=_useState22[1];var handleMenu=function handleMenu(index){setActiveIndex(index);};var telegramBotToken=process.env.REACT_APP_BOT_TOKEN;var performTask=function performTask(taskId){var task=tasks.find(function(task){return task.id===taskId;});window.open(task.link,'_blank');setTimeout(function(){setShowVerifyButtons(_objectSpread(_objectSpread({},showVerifyButtons),{},_defineProperty({},taskId,true)));},2000);// Show Verify button 2 seconds after clicking Perform\n};var checkTelegramMembership=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(taskId){var task,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;task=tasks.find(function(task){return task.id===taskId;});_context.next=4;return axios.get(\"https://api.telegram.org/bot\".concat(telegramBotToken,\"/getChatMember\"),{params:{chat_id:task.chatId,user_id:id// Use the user's Firestore document ID as the Telegram user ID\n}});case 4:response=_context.sent;if(response.data.ok&&(response.data.result.status==='member'||response.data.result.status==='administrator'||response.data.result.status==='creator')){// Update task verification status in Firestore\nsetTasks(tasks.map(function(task){return task.id===taskId?_objectSpread(_objectSpread({},task),{},{verified:true}):task;}));}else{setCurrentError(_defineProperty({},taskId,\"Verification failed, Join the channel to verify.\"));}_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.error('Error verifying Telegram membership:',_context.t0);setCurrentError(_defineProperty({},taskId,\"Verification failed, Could not verify Telegram membership.\"));case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function checkTelegramMembership(_x){return _ref.apply(this,arguments);};}();var startCountdown=function startCountdown(taskId){setCurrentError({});// Reset error state\nsetCountdowns(_objectSpread(_objectSpread({},countdowns),{},_defineProperty({},taskId,5)));var countdownInterval=setInterval(function(){setCountdowns(function(prevCountdowns){var newCountdown=prevCountdowns[taskId]-1;if(newCountdown<=0){clearInterval(countdownInterval);setCountdownFinished(_objectSpread(_objectSpread({},countdownFinished),{},_defineProperty({},taskId,true)));return _objectSpread(_objectSpread({},prevCountdowns),{},_defineProperty({},taskId,0));}return _objectSpread(_objectSpread({},prevCountdowns),{},_defineProperty({},taskId,newCountdown));});},1000);checkTelegramMembership(taskId);// Call the API immediately\n};var claimTask=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(taskId){var task,userDocRef;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setClaiming(_objectSpread(_objectSpread({},claiming),{},_defineProperty({},taskId,true)));setClaimError('');_context2.prev=2;task=tasks.find(function(task){return task.id===taskId;});userDocRef=doc(db,'telegramUsers',id);_context2.next=7;return updateDoc(userDocRef,{balance:increment(task.bonus),tasksCompleted:arrayUnion(taskId)});case 7:// Update the balance and completedTasks state\nsetBalance(function(prevBalance){return prevBalance+task.bonus;});setCompletedTasks(function(prevCompletedTasks){return[].concat(_toConsumableArray(prevCompletedTasks),[taskId]);});setClaimedBonus(task.bonus);setModalOpen(true);setCongrats(true);setTimeout(function(){setCongrats(false);},4000);_context2.next=19;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](2);console.error('Error claiming task:',_context2.t0);setClaimError('Failed to claim the task. Please try again.');case 19:_context2.prev=19;setClaiming(_objectSpread(_objectSpread({},claiming),{},_defineProperty({},taskId,false)));return _context2.finish(19);case 22:case\"end\":return _context2.stop();}}},_callee2,null,[[2,15,19,22]]);}));return function claimTask(_x2){return _ref2.apply(this,arguments);};}();var closeModal=function closeModal(){setModalOpen(false);};var formatNumber=function formatNumber(number){if(number===undefined||number===null||isNaN(number)){return'';}if(number>=1000000){return(number/1000000).toFixed()+'M';}else if(number>=100000){return(number/1000).toFixed(0)+'K';}else{return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\" \");}};// const formatNumberCliam = (num) => {\n//   if (num < 100000) {\n//     return new Intl.NumberFormat().format(num).replace(/,/g, \" \");\n//   } else if (num < 1000000) {\n//     return new Intl.NumberFormat().format(num).replace(/,/g, \" \");\n//   } else {\n//     return (num / 1000000).toFixed(3).replace(\".\", \".\") + \" M\";\n//   }\n// };\nvar formatNumberCliam=function formatNumberCliam(num){if(num<100000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else if(num<1000000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else{return(num/1000000).toFixed(3).replace(\".\",\".\")+\" M\";}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Animate,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full pt-1 justify-center flex-col space-y-6 px-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex justify-between\",children:[/*#__PURE__*/_jsxs(NavLink,{to:\"/checkin\",className:\"font-medium text-[15px] text-[#C7B292] flex items-center justify-center space-x-1 relative\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-[10px] h-[10px] animate-pulse bg-green-500 rounded-full flex items-center\"}),/*#__PURE__*/_jsx(\"span\",{className:\"\",children:\"Daily Checkin\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center\",children:[\"  \",/*#__PURE__*/_jsx(RiArrowRightSLine,{size:18,className:\"\"}),\" \"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-fit py-[2px] px-3 flex items-center space-x-1 justify-center border-[1px] border-[#707070] rounded-[25px]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-[14px]\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"engy\",src:images.logo,className:\"w-full\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-[15px] font-bold\",children:formatNumberCliam(balance+refBonus)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex items-center justify-between border-cards border-[1px] p-1 rounded-[8px]\",children:[/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return handleMenu(1);},className:\"\".concat(activeIndex===1?'bg-cards text-[#ebebeb]':'',\"  rounded-[6px] text-primary py-[10px] px-3 w-[33%] flex space-x-1 justify-center text-center text-[14px] font-semibold items-center\"),children:[/*#__PURE__*/_jsx(PiNotebook,{size:16,className:\"\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Tasks\"})]}),/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return handleMenu(2);},className:\"\".concat(activeIndex===2?'bg-cards text-[#ebebeb]':'',\"  rounded-[6px] text-primary py-[10px] px-3 w-[33%] space-x-1 font-semibold text-[14px] flex justify-center text-center items-center\"),children:[/*#__PURE__*/_jsx(PiYoutubeLogo,{size:16,className:\"\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"relative\",children:[\"Videos\",/*#__PURE__*/_jsx(\"span\",{className:\"absolute h-[8px] w-[8px] bg-red-500 animate-pulse rounded-full -right-3 top-0\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return handleMenu(3);},className:\"\".concat(activeIndex===3?'bg-cards text-[#ebebeb]':'',\"  rounded-[6px] text-primary py-[10px] px-3 w-[33%] space-x-1 font-semibold text-[14px] flex justify-center text-center items-center\"),children:[/*#__PURE__*/_jsx(PiUsersThree,{size:16,className:\" mt-[-2px]\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Referrals\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"refer\",className:\"w-full h-[80vh] !mt-3 scroller rounded-[10px] overflow-y-auto pt-2 pb-[250px]\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(activeIndex===1?'block':'hidden',\" w-full flex items-end justify-center flex-col space-y-4\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-1\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-[18px] font-semibold -mt-2\",children:\"Social Tasks\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[14px] text-[#c6c6c6] leading-[24px] pr-8\",children:\"Perform social tasks to earn more Maxtap tokens and stay updated!\"})]}),tasks.map(function(task){return/*#__PURE__*/_jsx(\"div\",{class:\"w-[93%] rounded-[25px] bg-gradient-to-r from-[#454545] to-[#575349] p-[1px]\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"flex h-full w-full flex-col bg-[#2d2d2d] justify-center rounded-[24px] py-4 pl-12 pr-4 relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-[60px] h-[60px] rounded-[12px] p-2 absolute bsg-[#8a8a8a] bg-[#6b69699c] left-[-7%] todp-[40px] flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"engy\",src:task.icon,className:\"w-[40px]\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full flex-col justify-between h-full space-y-2\",children:[/*#__PURE__*/_jsx(\"h1\",{class:\"text-[15px] text-nowrap line-clamp-1 mr-[5px] font-medium\",children:task.title}),/*#__PURE__*/_jsxs(\"span\",{className:\"flex text-primary items-center w-fit space-x-1 text-[14px] font-semibold\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-[10px] h-[10px] bg-btn4 rounded-full flex items-center\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"\",children:[\"+\",formatNumber(task.bonus)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex items-center justify-between flex-wrap text-[14px] relative\",children:[!completedTasks.includes(task.id)&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return performTask(task.id);},className:\"w-fit py-[6px] px-4 font-medium bg-[#595959cc] hover:bg-[#8a8a8a] text-[#fff] hover:text-[#000] ease-in duration-200 rounded-[6px] \".concat(task.verified&&countdownFinished[task.id]?'hidden':''),disabled:task.verified&&countdownFinished[task.id],children:\"Perform\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return startCountdown(task.id);},className:\"w-fit py-[6px] px-4 font-medium rounded-[6px] \".concat(countdowns[task.id]?'hidden':showVerifyButtons[task.id]?\"bg-btn4\":'bg-btn2 text-[#888]'),disabled:!showVerifyButtons[task.id]||task.verified&&countdownFinished[task.id],children:\"Verify\"})]}),countdowns[task.id]?/*#__PURE__*/_jsxs(\"span\",{className:\"w-fit py-[6px] px-4 font-medium bg-btn2 rounded-[6px]\",children:[\"checking.. \",countdowns[task.id],\"s\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[task.verified&&countdownFinished[task.id]&&!completedTasks.includes(task.id)?/*#__PURE__*/_jsx(\"span\",{className:\"w-fit py-[6px] px-[1.2rem] absolute left-[-1px] font-medium bg-[#494949] text-[#b8b8b8] rounded-[6px]\",children:\"Done\"}):currentError[task.id]&&/*#__PURE__*/_jsx(\"span\",{className:\"text-accent pt-2 text-xs w-full\",children:currentError[task.id]}),completedTasks.includes(task.id)&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-fit py-[6px] px-4 font-medium bg-[#494949] text-[#b8b8b8] rounded-[6px]\",children:\"Completed\"}),/*#__PURE__*/_jsx(\"span\",{className:\"mr-[6px]\",children:/*#__PURE__*/_jsx(IoCheckmarkCircleSharp,{size:24,className:\"text-accent\"})})]})]}),!completedTasks.includes(task.id)&&/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return claimTask(task.id);},disabled:!task.verified||claiming[task.id]||!countdownFinished[task.id],className:\"w-fit py-[6px] px-4 font-medium bg-btn4 rounded-[6px] \".concat(task.verified&&countdownFinished[task.id]?'':'hidden'),children:claiming[task.id]?'Claiming...':'Claim'})]}),claimError&&/*#__PURE__*/_jsx(\"p\",{className:\"text-accent pt-2 text-xs w-full\",children:claimError})]})]})},task.id);}),/*#__PURE__*/_jsx(ManualTasks,{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(activeIndex===2?'block':'hidden',\" w-full flex items-end justify-center flex-col space-y-4\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-1\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-[18px] font-semibold -mt-2\",children:\"Watch & earn\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[14px] text-[#c6c6c6] leading-[24px] pr-8\",children:\"Watch video ads and earn high token rewards daily!\"})]}),/*#__PURE__*/_jsx(YouTubeTasks,{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(activeIndex===3?'block':'hidden',\" w-full flex items-end justify-center flex-col space-y-4\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-1\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-[18px] font-semibold -mt-2\",children:\"Invite friends, get rewards!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[14px] leading-[24px] pr-8\",children:\"The more frens you refer, the more you earn and get rewarded!\"})]}),/*#__PURE__*/_jsx(Referrals,{})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full absolute top-[50px] left-0 right-0 flex justify-center z-50 pointer-events-none select-none\",children:congrats?/*#__PURE__*/_jsx(\"img\",{src:\"/congrats.gif\",alt:\"congrats\",className:\"w-[80%]\"}):/*#__PURE__*/_jsx(_Fragment,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(modalOpen===true?\"visible\":\"invisible\",\" fixed top-[-12px] bottom-0 left-0 z-40 right-0 h-[100vh] bg-[#00000042] flex justify-center items-center backdrop-blur-[6px] px-4\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(modalOpen===true?\"opacity-100 mt-0 ease-in duration-300\":\"opacity-0 mt-[100px]\",\" w-full bg-modal relative rounded-[16px] flex flex-col justify-center p-8\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex justify-center flex-col items-center space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full items-center justify-center flex flex-col space-y-2\",children:[/*#__PURE__*/_jsx(IoCheckmarkCircleSharp,{size:32,className:\"text-accent\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:\"Let's go!!\"})]}),/*#__PURE__*/_jsxs(\"h3\",{className:\"font-medium text-[20px] text-[#ffffff] pt-2 pb-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-accent\",children:[\"+\",formatNumberCliam(claimedBonus)]}),\" \",texts.projectSymbol,\" CLAIMED\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"pb-6 text-[#9a96a6] text-[15px] w-full text-center\",children:[\"Keep performing new tasks! something huge is coming! Perform more and earn more \",texts.projectSymbol,\" now!\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:closeModal,className:\"bg-btn4 w-fit py-[10px] px-6 flex items-center justify-center text-center rounded-[12px] font-medium text-[16px]\",children:\"Continue tasks\"})})]})}),/*#__PURE__*/_jsx(Levels,{showLevel:showLevel,setShowLevel:setShowLevel})]}),/*#__PURE__*/_jsx(Outlet,{})]})});};export default TasksList;","map":null,"metadata":{},"sourceType":"module"}