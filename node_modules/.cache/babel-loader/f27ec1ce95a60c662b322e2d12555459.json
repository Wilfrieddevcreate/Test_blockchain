{"ast":null,"code":"import _defineProperty from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _toConsumableArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\wilfr\\\\OneDrive\\\\Documents\\\\maxitapbotlatestversionv2\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from'react';import{db}from'../firebase/firestore';// adjust the path as needed\nimport{collection,doc,deleteDoc,query,getDocs,orderBy,limit,startAfter}from\"firebase/firestore\";import{MdOutlineContentCopy}from\"react-icons/md\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AdminAirdrop=function AdminAirdrop(){// eslint-disable-next-line \nvar _useState=useState(''),_useState2=_slicedToArray(_useState,2),successMessage=_useState2[0],setSuccessMessage=_useState2[1];// eslint-disable-next-line \nvar _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),users=_useState6[0],setUsers=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),addresses=_useState8[0],setAddresses=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),lastVisible=_useState10[0],setLastVisible=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),dropdownVisible=_useState14[0],setDropdownVisible=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),copied=_useState16[0],setCopied=_useState16[1];var copyToClipboard=function copyToClipboard(address){if(navigator.clipboard&&navigator.clipboard.writeText){navigator.clipboard.writeText(address).then(function(){setCopied(true);setTimeout(function(){return setCopied(false);},2000);}).catch(function(err){console.error('Failed to copy text: ',err);});}else{var textArea=document.createElement('textarea');textArea.value=address;document.body.appendChild(textArea);textArea.select();try{document.execCommand('copy');setCopied(true);setTimeout(function(){return setCopied(false);},2000);}catch(err){console.error('Failed to copy',err);}document.body.removeChild(textArea);}};var handleDeleteUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userId){var userDoc;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;userDoc=doc(db,\"telegramUsers\",userId);_context.next=4;return deleteDoc(userDoc);case 4:setUsers(users.filter(function(user){return user.id!==userId;}));setAddresses(function(prevAddresses){var newAddresses=_objectSpread({},prevAddresses);delete newAddresses[userId];return newAddresses;});setSuccessMessage('User successfully deleted!');_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.error(\"Error deleting user: \",_context.t0);setErrorMessage('Error deleting user');case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function handleDeleteUser(_x){return _ref.apply(this,arguments);};}();var fetchUsers=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var loadMore,usersRef,usersQuery,userSnapshot,lastVisibleDoc,fetchedUsers,newAddresses,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:loadMore=_args2.length>0&&_args2[0]!==undefined?_args2[0]:false;setLoading(true);_context2.prev=2;usersRef=collection(db,\"telegramUsers\");usersQuery=loadMore&&lastVisible?query(usersRef,orderBy(\"balance\",\"desc\"),startAfter(lastVisible),limit(50)):query(usersRef,orderBy(\"balance\",\"desc\"),limit(50));_context2.next=7;return getDocs(usersQuery);case 7:userSnapshot=_context2.sent;lastVisibleDoc=userSnapshot.docs[userSnapshot.docs.length-1];setLastVisible(lastVisibleDoc);fetchedUsers=userSnapshot.docs.map(function(doc){return _objectSpread({id:doc.id},doc.data());}).filter(function(user){return user.address&&user.address.trim()!=='';});newAddresses=fetchedUsers.reduce(function(acc,user){acc[user.id]=user.address;return acc;},{});setUsers(loadMore?[].concat(_toConsumableArray(users),_toConsumableArray(fetchedUsers)):fetchedUsers);setAddresses(loadMore?_objectSpread(_objectSpread({},addresses),newAddresses):newAddresses);_context2.next=20;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](2);console.error(\"Error fetching users: \",_context2.t0);setErrorMessage('Error fetching users');case 20:_context2.prev=20;setLoading(false);return _context2.finish(20);case 23:case\"end\":return _context2.stop();}}},_callee2,null,[[2,16,20,23]]);}));return function fetchUsers(){return _ref2.apply(this,arguments);};}();useEffect(function(){fetchUsers();// eslint-disable-next-line \n},[]);var toggleDropdown=function toggleDropdown(userId){setDropdownVisible(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},userId,!prevState[userId]));});};var formatNumber=function formatNumber(num){if(num<100000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else if(num<1000000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else{return(num/1000000).toFixed(3).replace(\".\",\".\")+\" M\";}};return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex flex-col space-y-4 h-[100vh] scroller pt-4 overflow-y-auto pb-[150px]\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full sm:w-[50%] flex flex-col space-y-3\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-[20px] font-semibold\",children:\"Eligible for Airdrop\"}),users.map(function(user,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-cards p-4 rounded-[10px] text-[13px] relative flex flex-col w-full space-y-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"flex w-full items-center space-x-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-[16px] h-[16px] flex justify-center items-center rounded-full bg-[#000]\",children:/*#__PURE__*/_jsx(\"strong\",{children:index+1})}),/*#__PURE__*/_jsx(\"span\",{className:\"line-clamp-1 font-semibold\",children:user.username})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center gap-1 psl-1\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/coins.webp\",alt:\"balance\",className:\"w-[14px] h-[14px] rounded-full\"}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-accent\",children:formatNumber(user.balance)})})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-start w-full gap-1 pls-[1px]\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/binance.webp\",alt:\"User Level\",className:\"w-[14px] rounded-full h-[14px] mt-1\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-secondary break-all text-wrap flex items-start w-full justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"flex w-[80%]\",children:user.address}),/*#__PURE__*/_jsx(MdOutlineContentCopy,{size:20,className:\"w-[20%]\",onClick:function onClick(){return copyToClipboard(user.address);}})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return toggleDropdown(user.id);},className:\"absolute top-2 right-2 bg-gray-900 text-white rounded-full p-2 h-[28px] w-[28px] flex items-center justify-center\",children:\"\\u22EE\"}),dropdownVisible[user.id]&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-10 top-8 right-2 bg-[#2e2e2e] text-primary rounded-md shadow-lg w-40\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleDeleteUser(user.id);},className:\"block w-full text-left px-4 py-2 hover:bg-[#7a7a7a33]\",children:\"Delete User\"})})]},user.id);}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return fetchUsers(true);},disabled:loading,className:\"bg-[#f5bb5f] font-semibold text-[15px] rounded-[6px] w-full sm:w-[200px] h-fit px-4 py-3 text-[#000] mt-4\",children:loading?'Loading...':'Load More Users'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(copied===true?\"visible top-6\":\"invisible top-[-10px]\",\" z-[60] ease-in duration-300 w-full fixed left-0 right-0 px-4\"),children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full text-[#54d192] flex items-center justify-center space-x-2 px-4 bg-[#121620ef] h-[50px] rounded-[8px]\",children:/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Wallet address copied!\"})})})]});};export default AdminAirdrop;","map":null,"metadata":{},"sourceType":"module"}