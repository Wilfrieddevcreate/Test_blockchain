{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\wilfr\\\\OneDrive\\\\Documents\\\\maxitapbotlatestversionv2\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useRef,useState}from'react';import{useIsConnectionRestored,useTonAddress,useTonConnectUI}from'@tonconnect/ui-react';import{IoCheckmarkCircle,IoCloseCircle}from\"react-icons/io5\";import{MdOutlineKeyboardArrowRight}from\"react-icons/md\";import{TonConnectButton}from\"@tonconnect/ui-react\";// import ErrorBoundary from \"../Components/ErrorBoundary\";\nimport{doc,updateDoc}from'firebase/firestore';// Import Firestore functions\nimport{db}from'../firebase/firestore';import{useUser}from'../context/userContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var Address=function Address(){var _useUser=useUser(),id=_useUser.id,isAddressSaved=_useUser.isAddressSaved,setWalletAddress=_useUser.setWalletAddress,setIsAddressSaved=_useUser.setIsAddressSaved;var userFriendlyAddress=useTonAddress();// const rawAddress = useTonAddress(false);\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),disconnect=_useState2[0],setDisconnect=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),openInfoTwo=_useState4[0],setOpenInfoTwo=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),openInfo=_useState6[0],setOpenInfo=_useState6[1];var infoRefTwo=useRef(null);var infoRef=useRef(null);var handleClickOutside=function handleClickOutside(event){if(infoRefTwo.current&&!infoRefTwo.current.contains(event.target)){setOpenInfoTwo(false);}if(infoRef.current&&!infoRef.current.contains(event.target)){setOpenInfo(false);}};useEffect(function(){if(openInfoTwo||openInfo){document.addEventListener('mousedown',handleClickOutside);}else{document.removeEventListener('mousedown',handleClickOutside);}return function(){document.removeEventListener('mousedown',handleClickOutside);};},[openInfoTwo,openInfo]);var clearCache=function clearCache(){// Clear Local Storage\nlocalStorage.clear();// Clear Session Storage\nsessionStorage.clear();// Clear Service Worker Caches\nif('caches'in window){caches.keys().then(function(names){names.forEach(function(name){caches.delete(name);});});}};// const connectionRestored = useIsConnectionRestored();\nvar _useTonConnectUI=useTonConnectUI(),_useTonConnectUI2=_slicedToArray(_useTonConnectUI,1),tonConnectUI=_useTonConnectUI2[0];var connectionRestored=useIsConnectionRestored();useEffect(function(){if(!connectionRestored){setTimeout(function(){clearCache();},8000);}});// Function to handle disconnection\nvar handleDisconnect=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var userRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:userRef=doc(db,'telegramUsers',id.toString());_context.prev=1;_context.next=4;return updateDoc(userRef,{address:'',isAddressSaved:false});case 4:setIsAddressSaved(false);setWalletAddress('');setDisconnect(!disconnect);setOpenInfo(false);console.log('Address disconnected successfully');_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);console.error('Error deleting address:',_context.t0);case 14:disconn();case 15:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function handleDisconnect(){return _ref.apply(this,arguments);};}();var disconn=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return tonConnectUI.disconnect();case 3:console.log('Disconnected successfully');_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.error('Error during disconnection:',_context2.t0);case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function disconn(){return _ref2.apply(this,arguments);};}();var disco=function disco(){setDisconnect(!disconnect);};// Function to save address to Firestore\nvar saveAddressToFirestore=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var userRef;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:userRef=doc(db,'telegramUsers',id.toString());_context3.prev=1;_context3.next=4;return updateDoc(userRef,{address:userFriendlyAddress,isAddressSaved:true});case 4:setIsAddressSaved(true);setWalletAddress(userFriendlyAddress);console.log('Address saved successfully');_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);console.error('Error saving address:',_context3.t0);case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[1,9]]);}));return function saveAddressToFirestore(){return _ref3.apply(this,arguments);};}();// Use effect to save address whenever it changes\nuseEffect(function(){if(!isAddressSaved&&userFriendlyAddress){saveAddressToFirestore();}// eslint-disable-next-line \n},[userFriendlyAddress]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-full rounded-[15px] flex flex-col justify-center items-end relative\",children:userFriendlyAddress!==''?/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return setOpenInfo(true);},className:\"bg-[#a4a4a424] flex h-full w-fit rounded-full items-center py-[10px] px-3 relative space-x-1\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/wallet.webp\",alt:\"connect\",className:\"w-[16px] -mt-[2px]\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-[13px] small-text2 text-left pr-3 text-nowrap text-white flex flex-1 flex-col\",children:/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-[#d1d1d1] line-clamp-1 break-all text-wrap\",children:userFriendlyAddress})}),/*#__PURE__*/_jsx(IoCheckmarkCircle,{size:20,className:\"text-[#40863d]\"})]}):/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return setOpenInfoTwo(true);},className:\"bsg-[#319cdf74] bg-[#319cdf] flex h-full w-fit rounded-full items-center py-[10px] px-3 relative space-x-1\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/wallet.webp\",alt:\"connect\",className:\"w-[16px] -mt-[2px]\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-[13px] small-text2 text-left pr-6 text-nowrap text-white flex flesx-1 flex-col\",children:\"Connect your wallet\"}),/*#__PURE__*/_jsx(MdOutlineKeyboardArrowRight,{size:20,className:\"text-[#fff] absolute right-2\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(openInfo===true?\"visible\":\"invisible\",\" fixed bottom-0 left-0 z-40 right-0 h-[100vh] bg-[#00000042] flex justify-center items-center backdrop-blur-[6px] px-4\"),children:/*#__PURE__*/_jsxs(\"div\",{ref:infoRef,className:\"\".concat(openInfo===true?\"opacity-100 mt-0 ease-in duration-300\":\"opacity-0 mt-[100px]\",\" w-full bg-modal absolute bottom-0 left-0 right-0 rounded-tr-[20px] rounded-tl-[20px] flex flex-col justify-center p-8\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-fit flex justify-center absolute right-6 top-6\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setOpenInfo(false);},className:\"w-fit flex items-center justify-center text-center rounded-[12px] font-medium text-[16px]\",children:/*#__PURE__*/_jsx(IoCloseCircle,{size:32,className:\"text-[#8f8f8f]\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center flex-col items-center space-y-3 pt-6 pb-32\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full items-center justify-center flex flex-col space-y-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-[72px] flex items-center\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/wallet.webp\",alt:\"connect\",className:\"w-full\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-green-500 text-[22px] w-full text-center\",children:\"Your wallet is connected\"}),/*#__PURE__*/_jsx(\"p\",{className:\"pb-6 text-[#bfbfbf] text-[14px] w-full text-center\",children:\"Continue performing tasks and await airdrop distribution!\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex flex-col items-center justify-center space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex flex-col items-center justify-center space-y-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:disco,className:\"bg-red-500 w-fit py-2 px-10 text-center rounded-[25px]\",children:\"Disconnect wallet\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(disconnect?'flex':'hidden',\" px-4 py-2 text-[13px] text-center rounded-[8px] flex flex-col\"),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-[#ffffff] pb-2\",children:\"Are you sure you want to disconnect? Only connected wallets are eligible for airdrop\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleDisconnect,className:\"font-medium bg-[#eb4848] w-fit rounded-[25px] px-4 py-1\",children:\"Yes Disconnect wallet\"})})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setOpenInfo(false);},className:\"bg-[#fff] text-[#000] py-2 px-8 text-center rounded-[25px]\",children:\"Go back\"})]})]})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(openInfoTwo===true?\"visible\":\"invisible\",\" fixed bottom-0 left-0 z-40 right-0 h-[100vh] bg-[#00000042] flex justify-center items-center backdrop-blur-[6px] px-4\"),children:/*#__PURE__*/_jsxs(\"div\",{ref:infoRefTwo,className:\"\".concat(openInfoTwo===true?\"opacity-100 mt-0 ease-in duration-300\":\"opacity-0 mt-[100px]\",\" w-full bg-modal absolute bottom-0 left-0 right-0 rounded-tr-[20px] rounded-tl-[20px] flex flex-col justify-center p-8\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-fit flex justify-center absolute right-6 top-6\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setOpenInfoTwo(false);},className:\"w-fit flex items-center justify-center text-center rounded-[12px] font-medium text-[16px]\",children:/*#__PURE__*/_jsx(IoCloseCircle,{size:32,className:\"text-[#8f8f8f]\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center flex-col items-center space-y-3 pt-6 pb-32\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full items-center justify-center flex flex-col space-y-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-[72px] flex items-center\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/wallet.webp\",alt:\"connect\",className:\"w-full\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-[22px] w-full text-center\",children:\"Connect your TON wallet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"pb-6 text-[#bfbfbf] text-[14px] w-full text-center\",children:\"Connect your crypto wallet to receive airdrop allocation. If you don't have one, create one in your Telegram account\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex flex-col items-center justify-center space-y-4\",children:/*#__PURE__*/_jsx(TonConnectButton,{className:\"!w-full\"})})]})})]})})]});};","map":null,"metadata":{},"sourceType":"module"}