{"ast":null,"code":"import _toConsumableArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/wilfr/OneDrive/Documents/maxitapbotlatestversionv2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\wilfr\\\\OneDrive\\\\Documents\\\\maxitapbotlatestversionv2\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from'react';import{doc,updateDoc,arrayUnion,increment}from'firebase/firestore';import{db}from'../firebase/firestore';import{useUser}from\"../context/userContext\";import{IoCheckmarkCircleSharp,IoCheckmarkCircle,IoClose}from'react-icons/io5';import{CiNoWaitingSign}from'react-icons/ci';// const youtubeTasks = [\n//     {\n//         title: 'Watch youtube video',\n//         description: 'Watch this video about generating income through cryptocurrency',\n//         link: 'https://t.me/plutotapofficials',\n//         icon: '/youtube2.svg',\n//         thumb: '/thumb2.webp',\n//         id: 1,\n//         bonus: 100000,\n//     }\n// ];\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var YouTubeTasks=function YouTubeTasks(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),showVerifyButtons=_useState2[0],setShowVerifyButtons=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),countdowns=_useState4[0],setCountdowns=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),buttonText=_useState6[0],setButtonText=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),modalOpen=_useState8[0],setModalOpen=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),modalMessage=_useState10[0],setModalMessage=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),claiming=_useState12[0],setClaiming=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),submittedYt=_useState14[0],setSubmittedYt=_useState14[1];var _useUser=useUser(),userId=_useUser.id,youtubeTasks=_useUser.youtubeTasks,userYoutubeTasks=_useUser.userYoutubeTasks,setUserYoutubeTasks=_useUser.setUserYoutubeTasks,setBalance=_useUser.setBalance;var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),claimedBonus=_useState16[0],setClaimedBonus=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),congrats=_useState18[0],setCongrats=_useState18[1];var _useState19=useState(null),_useState20=_slicedToArray(_useState19,2),openTask=_useState20[0],setOpenTask=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),active=_useState22[0],setActive=_useState22[1];useEffect(function(){var handleBackButtonClick=function handleBackButtonClick(){setOpenTask(false);};if(openTask){window.Telegram.WebApp.BackButton.show();window.Telegram.WebApp.BackButton.onClick(handleBackButtonClick);}else{window.Telegram.WebApp.BackButton.hide();window.Telegram.WebApp.BackButton.offClick(handleBackButtonClick);}return function(){window.Telegram.WebApp.BackButton.offClick(handleBackButtonClick);};},[openTask]);var performTask=function performTask(taskId){var task=youtubeTasks.find(function(task){return task.id===taskId;});if(task){window.open(task.link,'_blank');setTimeout(function(){setShowVerifyButtons(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},taskId,true));});},120000);setTimeout(function(){setActive(true);},2000);}};var startCountdown=function startCountdown(taskId){setCountdowns(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},taskId,5));});setButtonText(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},taskId,'Verifying'));});var countdownInterval=setInterval(function(){setCountdowns(function(prevCountdowns){var newCountdown=prevCountdowns[taskId]-1;if(newCountdown<=0){clearInterval(countdownInterval);setCountdowns(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},taskId,null));});setButtonText(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},taskId,'Verifying'));});var saveTaskToUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var userDocRef,updatedUserYoutubeTasks;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;userDocRef=doc(db,'telegramUsers',userId);updatedUserYoutubeTasks=[].concat(_toConsumableArray(userYoutubeTasks),[{taskId:taskId,completed:false}]);_context.next=5;return updateDoc(userDocRef,{youtubeTasks:arrayUnion({taskId:taskId,completed:false})});case 5:setUserYoutubeTasks(updatedUserYoutubeTasks);// Update state to reflect the saved task\nconsole.log(\"Task \".concat(taskId,\" added to user's youtubeTasks collection\"));_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.error(\"Error adding task to user's document: \",_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function saveTaskToUser(){return _ref.apply(this,arguments);};}();saveTaskToUser();setSubmittedYt(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},taskId,true));});localStorage.setItem(\"submittedYt_\".concat(taskId),true);return _objectSpread(_objectSpread({},prevCountdowns),{},_defineProperty({},taskId,null));}return _objectSpread(_objectSpread({},prevCountdowns),{},_defineProperty({},taskId,newCountdown));});},1000);};var claimTask=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(taskId){var task,userDocRef;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setClaiming(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},taskId,true));});_context2.prev=1;task=youtubeTasks.find(function(task){return task.id===taskId;});userDocRef=doc(db,'telegramUsers',userId);_context2.next=6;return updateDoc(userDocRef,{youtubeTasks:userYoutubeTasks.map(function(task){return task.taskId===taskId?_objectSpread(_objectSpread({},task),{},{completed:true}):task;}),balance:increment(task.bonus)});case 6:setBalance(function(prevBalance){return prevBalance+task.bonus;});console.log(\"Task \".concat(taskId,\" marked as completed\"));setUserYoutubeTasks(function(prevTasks){return prevTasks.map(function(task){return task.taskId===taskId?_objectSpread(_objectSpread({},task),{},{completed:true}):task;});});setModalMessage(/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex justify-center flex-col items-center space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full items-center justify-center flex flex-col space-y-2\",children:[/*#__PURE__*/_jsx(IoCheckmarkCircleSharp,{size:32,className:\"text-btn4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-center\",children:\"Let's go!!\"})]}),/*#__PURE__*/_jsxs(\"h3\",{className:\"font-medium text-[20px] text-[#ffffff] pt-2 pb-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-btn4\",children:[\"+\",formatNumber(task.bonus)]}),\" NGT CLAIMED\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"pb-6 text-[15px] w-full text-center\",children:\"Keep performing new tasks! something huge is coming! Perform more and earn more NGT now!\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:closeModal,className:\"bg-btn4 text-[#000]  w-full py-3 px-3 flex items-center justify-center text-center rounded-[12px] font-semibold text-[16px]\",children:\"Continue tasks\"})})]}));setModalOpen(true);setClaimedBonus(task.bonus);setCongrats(true);setTimeout(function(){setCongrats(false);},4000);_context2.next=19;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](1);console.error(\"Error updating task status to completed: \",_context2.t0);case 19:setClaiming(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},taskId,false));});case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[1,16]]);}));return function claimTask(_x){return _ref2.apply(this,arguments);};}();var closeModal=function closeModal(){setModalOpen(false);setOpenTask(false);};var closeModal2=function closeModal2(){setModalOpen(false);setActive(false);};useEffect(function(){var submittedStatesYt=youtubeTasks.reduce(function(acc,task){var submittedStateYt=localStorage.getItem(\"submittedYt_\".concat(task.id))==='true';acc[task.id]=submittedStateYt;return acc;},{});setSubmittedYt(submittedStatesYt);// eslint-disable-next-line\n},[]);var formatNumber=function formatNumber(num){if(num<100000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else if(num<1000000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else{return(num/1000000).toFixed(3).replace(\".\",\".\")+\" M\";}};return/*#__PURE__*/_jsxs(_Fragment,{children:[youtubeTasks.sort(function(a,b){return a.id-b.id;}).map(function(task){var userTask=userYoutubeTasks.find(function(t){return t.taskId===task.id;});var isTaskCompleted=userTask?userTask.completed:false;return/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return setOpenTask(task);},className:\"w-full rounded-[16px] bg-cards p-4 pl-3 flex items-start space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"engy\",src:task.icon,className:\"w-[40px]\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex h-full w-full flex-col justify-center relative\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full flex-col justify-between h-full space-y-1\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-[15px] text-nowrap line-clamp-1 mr-[5px] font-medium\",children:task.title}),/*#__PURE__*/_jsxs(\"span\",{className:\"flex text-primary items-center w-fit space-x-1 text-[14px] font-semibold\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-[10px] h-[10px] bg-btn4 rounded-full flex items-center\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"\",children:[\"+\",formatNumber(task.bonus)]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex items-center justify-between flex-wrap text-[14px] relative\",children:isTaskCompleted?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-fit py-[6px] px-4 font-medium bg-[#494949] text-[#b8b8b8] rounded-[6px]\",children:\"Completed\"}),/*#__PURE__*/_jsx(\"span\",{className:\"mr-[6px]\",children:/*#__PURE__*/_jsx(IoCheckmarkCircleSharp,{size:24,className:\"text-btn4\"})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setOpenTask(task);},className:\"w-fit py-[6px] px-4 font-medium bg-[#8f8f8f85] hover:bg-[#8a8a8a] text-[#fff] hover:text-[#000] ease-in duration-200 rounded-[6px]\",children:\"Perform\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setOpenTask(task);},className:\"w-fit py-[6px] px-4 font-medium bg-btn2 text-[#888] ease-in duration-200 rounded-[6px]\",children:\"Pending\"})]})})]})})]},task.id);}),openTask&&/*#__PURE__*/_jsx(TaskModal,{task:openTask,onClose:function onClose(){return setOpenTask(null);},performTask:performTask,startCountdown:startCountdown,claimTask:claimTask,active:active,setActive:setActive,showVerifyButtons:showVerifyButtons,countdowns:countdowns,buttonText:buttonText,submittedYt:submittedYt,claiming:claiming,userYoutubeTasks:userYoutubeTasks,modalMessage:modalMessage,setModalMessage:setModalMessage,setModalOpen:setModalOpen,modalOpen:modalOpen,closeModal:closeModal,closeModal2:closeModal2,congrats:\"/congrats.gif\",claimedBonus:claimedBonus}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full absolute top-[50px] left-0 right-0 flex justify-center z-[60] pointer-events-none select-none\",children:congrats?/*#__PURE__*/_jsx(\"img\",{src:\"/celebrate.gif\",alt:\"congrats\",className:\"w-[80%]\"}):/*#__PURE__*/_jsx(_Fragment,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(modalOpen?\"visible\":\"invisible\",\" fixed top-[-12px] bottom-0 left-0 z-50 right-0 h-[100vh] bg-[#00000042] flex justify-center items-center backdrop-blur-[6px] px-4\"),children:/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(modalOpen?\"opacity-100 mt-0 ease-in duration-300\":\"opacity-0 mt-[100px]\",\" w-full bg-modal relative rounded-[16px] flex flex-col justify-center p-8\"),children:modalMessage})})]});};var TaskModal=function TaskModal(_ref3){var task=_ref3.task,onClose=_ref3.onClose,performTask=_ref3.performTask,startCountdown=_ref3.startCountdown,claimTask=_ref3.claimTask,showVerifyButtons=_ref3.showVerifyButtons,countdowns=_ref3.countdowns,buttonText=_ref3.buttonText,submittedYt=_ref3.submittedYt,claiming=_ref3.claiming,userYoutubeTasks=_ref3.userYoutubeTasks,active=_ref3.active,setActive=_ref3.setActive,modalMessage=_ref3.modalMessage,modalOpen=_ref3.modalOpen,closeModal=_ref3.closeModal,setModalMessage=_ref3.setModalMessage,setModalOpen=_ref3.setModalOpen,closeModal2=_ref3.closeModal2,congrats=_ref3.congrats,claimedBonus=_ref3.claimedBonus;var isTaskSaved=!!userYoutubeTasks.find(function(t){return t.taskId===task.id;});var isTaskCompleted=isTaskSaved&&userYoutubeTasks.find(function(t){return t.taskId===task.id;}).completed;var formatNumber=function formatNumber(num){if(num<100000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else if(num<1000000){return new Intl.NumberFormat().format(num).replace(/,/g,\" \");}else{return(num/1000000).toFixed(3).replace(\".\",\".\")+\" M\";}};var notVerified=function notVerified(){setModalOpen(true);setModalMessage(/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex justify-center flex-col items-center space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full items-center justify-center flex flex-col space-y-2\",children:[/*#__PURE__*/_jsx(CiNoWaitingSign,{size:32,className:\"text-btn4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-center\",children:\"You have not watched this video completely yet!\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"pb-6 text-[#9a96a6] text-[15px] w-full text-center\",children:\"Click on the watch video button and ensure you watch the video completely before you come back to claim your reward.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:closeModal2,className:\"bg-btn4 text-[#000]  w-full py-3 px-3 flex items-center justify-center text-center rounded-[12px] font-semibold text-[16px]\",children:\"Okay, Understood!\"})})]}));};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed z-50 left-0 right-0 top-[-12px] bottom-0 flex justify-center taskbg px-[16px]\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex flex-col items-center justify-start pt-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-end pt-4 pb-8\",children:/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"flex items-center justify-center h-[32px] w-[32px] rounded-full bg-[#383838] absolute right-6 top-4 text-center font-medium text-[16px]\",children:/*#__PURE__*/_jsx(IoClose,{size:20,className:\"text-[#9995a4]\"})})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-[20px] font-semibold w-full text-center\",children:task.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-secondary text-[15px] font-medium pt-1 pb-4 w-full text-center\",children:task.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-cards rounded-[10px] p-[14px] flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-1 items-center space-x-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/coin.webp\",className:\"w-[16px]\",alt:\"Coin Icon\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-secondary\",children:\"Reward:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[\"+\",formatNumber(task.bonus)]})]})]}),isTaskSaved||isTaskCompleted?/*#__PURE__*/_jsxs(\"span\",{className:\"text-center text-[14px] font-semibold text-[#49ee49] flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"\",children:\"Done\"}),/*#__PURE__*/_jsx(IoCheckmarkCircle,{size:20,className:\"\"})]}):/*#__PURE__*/_jsx(\"span\",{className:\"w-[14px] h-[14px] animate-pulse bg-btn4 rounded-full flex items-center\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-cards rounded-[10px] p-[14px] flex flex-col space-y-2 justify-center items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center items-center relative\",children:[/*#__PURE__*/_jsx(\"img\",{onClick:function onClick(){return performTask(task.id);},src:task.thumb,alt:\"thumb\",className:\"w-full aspect-video rounded-[8px]\"}),/*#__PURE__*/_jsx(\"img\",{onClick:function onClick(){return performTask(task.id);},src:\"/youtube.svg\",alt:\"rfcdsv\",className:\"absolute w-[60px]\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return performTask(task.id);},className:\"w-full py-[10px] px-4 font-medium bg-[#8f8f8f85] hover:bg-[#8a8a8a] text-[#fff] hover:text-[#000] ease-in duration-200 rounded-[6px]\",children:\"Watch video\"}),isTaskSaved||isTaskCompleted?/*#__PURE__*/_jsx(\"span\",{className:\"w-full py-[10px] px-4 font-medium bg-[#8f8f8f85] text-center text-[#7cf47c] ease-in duration-200 rounded-[6px]\",children:\"Done\"}):/*#__PURE__*/_jsx(_Fragment,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex flex-col space-y-2 items-center justify-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex items-center text-[14px] justify-center relative mt-1 mb-4\",children:[!showVerifyButtons[task.id]?/*#__PURE__*/_jsx(\"button\",{onClick:notVerified,disabled:!active,className:\"\".concat(active?'bg-btn4 text-[#000]':'bg-btn2 text-[#888]',\" w-full py-3 px-4 font-semibold rounded-[6px] text-[17px]\"),children:\"Verify\"}):/*#__PURE__*/_jsx(_Fragment,{children:!isTaskSaved&&!isTaskCompleted&&/*#__PURE__*/_jsx(_Fragment,{children:countdowns[task.id]===undefined&&/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return startCountdown(task.id);},className:\"\".concat(submittedYt[task.id]?\"bg-btn4 text-[#000]\":buttonText[task.id]||\"bg-btn4 text-[#000]\",\" \").concat(!showVerifyButtons[task.id]?\"!bg-btn2 !text-[#888]\":\"bg-btn3 text-[#000]\",\" w-full py-3 px-4 font-semibold rounded-[6px] text-[17px]\"),disabled:!showVerifyButtons[task.id],children:submittedYt[task.id]?'Verify':'Verify'})})}),countdowns[task.id]!==null&&countdowns[task.id]!==undefined&&/*#__PURE__*/_jsxs(\"span\",{className:\"w-full py-3 px-4 font-medium text-center rounded-[6px] bg-btn2 text-[#fff]\",children:[\"checking \",countdowns[task.id],\"s\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return claimTask(task.id);},className:\"\".concat(isTaskSaved&&!isTaskCompleted?'bg-btn4 text-[#000]':'bg-btn2 text-[#888]',\" w-full py-4 px-3 mt-6 flex items-center rounded-[12px] justify-center text-center text-[18px] font-semibold\"),disabled:claiming[task.id]||!isTaskSaved||isTaskCompleted,children:!isTaskCompleted?'Finish Task':'Task Completed'})]})]})]})})});};export default YouTubeTasks;","map":null,"metadata":{},"sourceType":"module"}